{% load static cloudinary tailwind_tags %}

<!DOCTYPE html>
<html lang="en">

  <head>

    {% block meta %}
      {% comment %} Define encoding and viewport meta tags {% endcomment %}
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      {% comment %} SEO Meta Tags {% endcomment %}

      {% comment %} Dynamic Meta Description based on page type {% endcomment %}
      <meta name="description" content="{% if product %}{{ product.description|striptags|truncatechars:155 }}{% elif post %}{{ post.meta_description|striptags|truncatechars:155 }}{% elif category %}{{ category.description|striptags|truncatechars:155 }}{% elif page_slug == 'about' %}Learn about Pointless Impressions, our mission, values, and the artists we support.{% else %}Discover and buy unique Pointillism art online at Pointless Impressions. Explore curated pieces, artist stories, and art education.{% endif %}" />

      {% comment %} Open Graph Tags {% endcomment %}
      <meta property="og:title" content="{% block og_title %}{% if product %}{{ product.name|truncatechars:200|striptags }} | Pointless Impressions{% elif post %}{{ post.title|striptags }} | Pointless Impressions{% elif category %}{{ category.name|truncatechars:200|striptags }} | Pointless Impressions{% elif page_slug == 'about' %}About Us | Pointless Impressions{% else %}Pointless Impressions – Unique Pointillism Art{% endif %}{% endblock %}" />
      <meta property="og:description" content="{% if product %}{{ product.description|striptags|truncatechars:155 }}{% elif post %}{{ post.meta_description|striptags|truncatechars:155 }}{% elif category %}{{ category.description|striptags|truncatechars:155 }}{% elif page_slug == 'about' %}Learn about Pointless Impressions, our mission, values, and the artists we support.{% else %}Discover and buy unique Pointillism art online at Pointless Impressions. Explore curated pieces, artist stories, and art education.{% endif %}" />
      <meta property="og:type" content="website" />
      <meta property="og:site_name" content="Pointless Impressions" />

      {% comment %} Open Graph Image Block: Dev uses local files, Prod uses Cloudinary {% endcomment %}
      {% if production %}
          {% if product and product.image %}
              <meta property="og:image" content="{% cloudinary product.image 'w_1200,h_630,c_fill,f_auto,q_auto' %}">
          {% elif post and post.featured_image %}
              <meta property="og:image" content="{% cloudinary post.featured_image 'w_1200,h_630,c_fill,f_auto,q_auto' %}">
          {% else %}
              <meta property="og:image" content="{% cloudinary 'logo_white_01.png' 'w_1200,h_630,c_fill,f_auto,q_auto' %}">
          {% endif %}
      {% else %}
          {% if product and product.image %}
              <meta property="og:image" content="{{ request.build_absolute_uri }}{{ product.image.url }}" />
          {% elif post and post.featured_image %}
              <meta property="og:image" content="{{ request.build_absolute_uri }}{{ post.featured_image.url }}" />
          {% else %}
              <meta property="og:image" content="{{ request.build_absolute_uri }}{{ MEDIA_URL }}logo_white_01.png" />
          {% endif %}
      {% endif %}

      {% comment %} Robots Meta Tags {% endcomment %}
      {% if page_slug == "login" or page_slug == "signup" or page_slug == "checkout" or page_slug == "account" or page_slug == "admin" %}
          <meta name="robots" content="noindex, nofollow">
          <meta name="googlebot" content="noindex, nofollow" />
      {% else %}
          <meta name="robots" content="index, follow">
          <meta name="googlebot" content="index, follow" />
      {% endif %}

      {% comment %} Canonical URL {% endcomment %}
      <link rel="canonical" href="{{ request.build_absolute_uri }}" />
      
      {% comment %} Favicon {% endcomment %}
      <link rel="icon" type="image/png" href="{% if production %}{% cloudinary 'logo_white_01.png' 'w_32,h_32,c_fit,f_auto,q_auto' %}{% else %}{{ MEDIA_URL }}logo_white_01.png{% endif %}" />
    {% endblock %}

    {% block extra_meta %}
    {% endblock %}

    <title>{% block title %}{% if product %}{{ product.name|striptags }} | Pointless Impressions{% elif post %}{{ post.title|striptags }} | Pointless Impressions{% elif category %}{{ category.name|striptags }} | Pointless Impressions{% elif page_slug == 'about' %}About Us | Pointless Impressions{% else %}Pointless Impressions – Unique Pointillism Art{% endif %}{% endblock %}</title>

    {% tailwind_preload_css %}
    {% tailwind_css %}

    {% block corejs %}
      <script src="https://kit.fontawesome.com/b28d0f6314.js" crossorigin="anonymous"></script>
    {% endblock %}

    {% block extra_head %}{% endblock %}

  </head>

  <body class="leading-normal tracking-normal">

    {% comment %} Header Content Area {% endcomment %}
    <header class="fixed top-0 z-50 w-full">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 p-4">
        {% include "includes/header.html" %}
      </div>
    </header>

    {% comment %} Main Content Area {% endcomment %}
    <main class="flex-1 pt-24 md:pt-28 lg:pt-32">
      {% comment %} Full Content Block for pages that need complete control {% endcomment %}
      {% block content %}
        
        {% comment %} Section 1 - Hero/Primary Section {% endcomment %}
        {% block section_1 %}
          {% if section_1_class %}
          <section class="py-16 {{ section_1_class }} w-full">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              {% block section_1_content %}{% endblock %}
            </div>
          </section>
          {% endif %}
        {% endblock %}

        {% comment %} Section 2 - Secondary Section {% endcomment %}
        {% block section_2 %}
          {% if section_2_class %}
          <section class="py-16 {{ section_2_class }} w-full">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              {% block section_2_content %}{% endblock %}
            </div>
          </section>
          {% endif %}
        {% endblock %}

        {% comment %} Section 3 - Tertiary Section {% endcomment %}
        {% block section_3 %}
          {% if section_3_class %}
          <section class="py-16 {{ section_3_class }} w-full">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              {% block section_3_content %}{% endblock %}
            </div>
          </section>
          {% endif %}
        {% endblock %}

      {% endblock content %}
    </main>

    {% comment %} Modals and Overlays {% endcomment %}
    {% block modals %}
    {% endblock %}

    {% comment %} Extra Modals and Overlays {% endcomment %}
    {% block extramodals %}
    {% endblock %}

    {% comment %} Notifications Area {% endcomment %}
    {% block notifications %}
    {% endblock %}

    {% comment %} Extra Notifications Area {% endcomment %}
    {% block extranotifications %}
    {% endblock %}

    {% comment %} Footer Content Area {% endcomment %}
    <footer class="p-4 shadow-inner">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 p-4">
        {% include 'includes/footer.html' %}
      </div>
    </footer>

    {% comment %} Extra JavaScript Files {% endcomment %}
    {% block postloadjs %}
      {% if production %}
        <script src="{% static 'js/header_footer.js' %}?v={{ STATIC_VERSION }}" defer></script>
      {% else %}
        <script src="{% static 'js/header_footer.js' %}" defer></script>
      {% endif %}
    {% endblock %}
  </body>

</html>