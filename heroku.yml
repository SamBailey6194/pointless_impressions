build:
  languages:
    - python
    - nodejs
  buildpacks:
    - heroku/nodejs
    - heroku/python

  config:
    DJANGO_SETTINGS_MODULE: pointless_impressions_src.pointless_impressions.settings.staging
    NODE_ENV: production
    DISABLE_COLLECTSTATIC: 0

  scripts:
    postbuild:
      - cd cd pointless_impressions_src/theme/static_src && npm install && npm run build && cd ../../../..
      - python manage.py collectstatic --noinput
      - python manage.py migrate --noinput

run:
  web: gunicorn pointless_impressions_src.pointless_impressions.wsgi.py
